<div *ngIf="maximizedObject === null" class="principalContent">
  <div id="collapseSearch" [ngbCollapse]="isCollapsedSearchSeccion" class='mb-3'>
    <div class="card">
      <div class="card-body">
        <!-- SEARCH SECTION -->
        <div class="d-flex align-items-center justify-content-between">
          <h5><i class="fa fa-search fa-2x mr-2" aria-hidden="true"></i> Búsqueda avanzada</h5>
          <i class="fa fa-window-maximize fa-2x " style='cursor: pointer;top: 7px;position: absolute;right: 9px;' aria-hidden="true" (click)="isCollapsedSearchSeccion=true"></i>
        </div>
        <hr>
        <form>
          <div class="form-row align-items-center">
            <div class="col-12 my-3">
              <label class="sr-only" for="findIput">Trámite o servicio</label>
              <div class="input-group mb-2">
                <div class="input-group-prepend">
                  <div class="input-group-text"><i class="fa fa-search" aria-hidden="true"></i></div>
                </div>
                <input type="text" class="form-control" id="findInput" placeholder="Trámite o servicio">
              </div>
            </div>
            <div class="col-12 col-lg-4">
              <label class="sr-only" for="fomDateInput">Dependencia</label>
              <div class="input-group mb-2">
                <div class="input-group-prepend">
                  <div class="input-group-text"><i class="fa fa-building" aria-hidden="true"></i></div>
                </div>
                <select class="custom-select">
                  <option selected disabled>Seleccione una dependencia</option>
                  <option value="1">One</option>
                  <option value="2">Two</option>
                  <option value="3">Three</option>
                </select>
              </div>
            </div>
            <div class="col-12 col-lg-4">
              <label class="sr-only" for="fomDateInput">Kiosco</label>
              <div class="input-group mb-2">
                <div class="input-group-prepend">
                  <div class="input-group-text"><i class="fa fa-building" aria-hidden="true"></i></div>
                </div>
                <select class="custom-select">
                  <option selected disabled>Seleccione un kiosco</option>
                  <option value="1">One</option>
                  <option value="2">Two</option>
                  <option value="3">Three</option>
                </select>
              </div>
            </div>
            <div class="col-12 col-lg-4">
              <label class="sr-only" for="fomDateInput">Trámite</label>
              <div class="input-group mb-2">
                <div class="input-group-prepend">
                  <div class="input-group-text"><i class="fa fa-id-card-o" aria-hidden="true"></i></div>
                </div>
                <select class="custom-select">
                  <option selected disabled>Seleccione una trámite</option>
                  <option value="1">One</option>
                  <option value="2">Two</option>
                  <option value="3">Three</option>
                </select>
              </div>
            </div>
            <div class="col-12 col-md-5">
              <label class="sr-only" for="fomDateInput">Desde</label>
              <div class="input-group mb-2">
                <div class="input-group-prepend">
                  <div class="input-group-text"><i class="fa fa-calendar" aria-hidden="true"></i></div>
                </div>
                <input type="date" class="form-control" id="fomDateInput" placeholder="Trámite o servicio">
              </div>
            </div>
            <div class="col-12 col-md-5">
                <label class="sr-only" for="fomDateInput">Hasta</label>
                <div class="input-group mb-2">
                  <div class="input-group-prepend">
                    <div class="input-group-text"><i class="fa fa-calendar" aria-hidden="true"></i></div>
                  </div>
                  <input type="date" class="form-control" id="fomDateInput" placeholder="Trámite o servicio">
                </div>
              </div>
            <div class="col-12 col-md-2 text-right">
              <button type="submit" class="btn btn-outline-secondary btn-lg mb-2">Buscar</button>
            </div>
          </div>
        </form>
        <!-- /SEARCH SECTION -->
        <!-- RESULTADO BUSQUEDA GENERAL -->
        <div class='m-3' *ngIf="searchResult">
          <h5>Se buscó <span class="badge badge-info" style='font-size: 1.5em'> {{ searchResult.general.palabra }} </span>, se encontraron <span style='font-size: 1.5em;'><strong>{{ searchResult.registrosEncontrados }}</strong></span> trámites</h5>
          <hr>
          <ngb-accordion #a="ngbAccordion" [closeOthers]="true" type="light">
            <ngb-panel *ngFor="let item of searchResult.listaTramites">
              <ng-template ngbPanelHeader>
                <div class="d-flex align-items-center justify-content-between">
                  <h5 class="m-0" ngbPanelToggle>{{ item.nombre }} <span class="badge badge-success ml-3">{{ item.realizados ? item.realizados.total : '0' }}</span></h5>
                  <div>
                      <button *ngIf="item.realizados" ngbPanelToggle class="btn btn-link p-0"><i class="fa fa-pie-chart fa-2x" aria-hidden="true"></i></button>
                  </div>
                </div>
              </ng-template>
              <ng-template ngbPanelContent>
                <!-- ACORDION CONTENT -->
                <canvas baseChart 
                  [data]="item.graph.data" 
                  [labels]="item.graph.labels" 
                  [chartType]="'pie'" 
                  [options]="item.graph.options"
                  [plugins]="item.graph.plugins" 
                  [legend]="item.graph.legend">
                </canvas>        
                <!-- /ACORDION CONTENT -->
              </ng-template>
            </ngb-panel>      
          </ngb-accordion>
        </div>
        <!-- /RESULTADO BUSQUEDA -->
      </div>
    </div>
  </div>

  <!-- TRAMITES Y SERVICIOS -->
  <div class="card bg-light border-info">
    <div class="card-header border-info">
      <div class="d-flex align-items-center justify-content-between">
        <h5 class="m-0">Total de trámites realizados <span class="badge badge-info" style='font-size: 1.5em;'> {{ totalTramitesRealizados }} </span> en el periodo de <strong style='font-size: 1.5em;'>enero</strong> a <strong style='font-size: 1.5em;'>{{ fechaActual | date:'MMMM' }}</strong></h5>
        <button type="button" class="btn btn-outline-primary" (click)="isCollapsedSearchSeccion = !isCollapsedSearchSeccion"
            [attr.aria-expanded]="!isCollapsedSearchSeccion" aria-controls="collapseSearch">
            <i class="fa fa-search fa-2x mr-2" aria-hidden="true"></i> 
        </button>
      </div>
    </div>
    <div class="card-body">
      <!-- /TRAMITES Y SERVICIOS -->
      <!-- GRAFICOS -->
      <div class="row">
        <div #cardRef class="col-12 col-md-12 col-lg-4" data-maximize=true *ngFor="let item of chartsActos">
          <div  name='card' class="card bg-light my-1" >
            <div class="card-header">
              <div class="d-flex align-items-center justify-content-between">
                <h5 class="m-0"> {{item.acto}} <span *ngIf="item.graph.total" class="badge badge-success mx-2" style='font-size: 1.5em;'> {{ item.graph.total }} </span></h5>
                <div>
                    <i class="fa fa-tag fa-2x" style='cursor: pointer;' aria-hidden="true" (click)="item.graph.legend=!item.graph.legend"></i>
                    <i class="fa fa-window-maximize fa-1x ml-3 maximizeBtn" style='cursor: pointer;' aria-hidden="true" (click)="maximizeCard($event, cardRef)"></i>                
                </div>
              </div>          
            </div>
            <div class="card-body">
              <canvas baseChart 
                [data]="item.graph.data" 
                [labels]="item.graph.labels" 
                [chartType]="'pie'" 
                [options]="item.graph.options"
                [plugins]="item.graph.plugins" 
                [legend]="item.graph.legend"
                (chartClick)="chartClicked($event,item)" >
              </canvas>
            </div>
          </div>
        </div>
      </div>
      <!-- ORIGENES DE SOLICITUDES -->
      <br>
      <h5><i class="fa fa-bar-chart fa-2x mr-2" aria-hidden="true"></i> Origen de solicitudes</h5>
      <hr>
      <div style="display: block" >
        <canvas baseChart
          height="100px"
          [datasets]="barCharOrigenSolicitudes.data"
          [labels]="barCharOrigenSolicitudes.labels"
          [options]="barCharOrigenSolicitudes.options"
          [plugins]="barCharOrigenSolicitudes.plugins"
          [legend]="barCharOrigenSolicitudes.legend"
          [chartType]="'bar'">
        </canvas>
      </div>
      <!-- /ORIGENES DE SOLICITUDES -->
      <!-- /GRAFICOS -->
    </div>
  </div>
</div>
<div *ngIf="maximizedObject !== null" class="maximizedContent">
  <div [innerHTML]="maximizedObject"></div>
</div>
